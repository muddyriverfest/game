<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Muddy River Festival â€” Wildlife Spotter</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #51a4ad;
    font-family: 'Segoe UI', Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    min-height: 100dvh;
    color: #fff;
    padding: 12px 8px 16px;
    overflow-x: hidden;
  }

  #branding {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    margin-bottom: 10px;
    width: 100%;
  }

  #logo-wrap {
    background: #1a2a1a;
    border-radius: 10px;
    padding: 10px 22px 8px;
    box-shadow: 0 2px 12px #0006;
    border: 1px solid #3a5a2a;
    max-width: 100%;
  }

  #mrf-logo {
    width: 340px;
    max-width: calc(100vw - 80px);
    height: auto;
    display: block;
  }

  #subtitle {
    font-size: 0.9rem;
    color: #b0d4f1;
    margin: 0;
    text-align: center;
    padding: 0 8px;
  }

  #website-link {
    color: #ffd331;
    text-decoration: none;
    font-weight: bold;
    letter-spacing: 0.5px;
  }

  #website-link:hover { text-decoration: underline; color: #ffe86a; }

  #hud {
    display: flex;
    gap: 20px;
    margin-bottom: 8px;
    font-size: 1.1rem;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
  }

  #hud span { font-weight: bold; color: #f9e04b; }

  #game-wrapper {
    position: relative;
    border: 3px solid #4a8f3f;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 32px #0008;
    /* Scale canvas to fit screen width while keeping aspect ratio */
    width: min(800px, 100vw - 16px);
    aspect-ratio: 800 / 450;
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
  }

  #scoreboard {
    margin-top: 10px;
    background: #0d2137cc;
    border-radius: 8px;
    padding: 8px 12px;
    display: flex;
    gap: 12px;
    font-size: 0.85rem;
    border: 1px solid #2c5f8a;
    flex-wrap: wrap;
    justify-content: center;
    max-width: min(800px, 100vw - 16px);
  }

  .score-entry { text-align: center; }
  .score-entry .animal-name { color: #aad4f5; font-size: 0.75rem; }
  .score-entry .points-label { color: #f9e04b; font-weight: bold; font-size: 0.95rem; }

  #message-box {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #000000cc;
    border: 2px solid #f9e04b;
    border-radius: 12px;
    padding: 20px 24px;
    text-align: center;
    display: none;
    z-index: 10;
    width: 86%;
    max-width: 340px;
  }

  #message-box h2 { font-size: 1.3rem; color: #f9e04b; margin-bottom: 8px; }
  #message-box p { margin-bottom: 14px; color: #cde; font-size: 0.9rem; line-height: 1.5; }

  #restart-btn {
    background: #4a8f3f;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 12px 32px;
    font-size: 1rem;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
    /* Larger touch target */
    min-height: 44px;
  }
  #restart-btn:hover, #restart-btn:active { background: #6abf5e; }

  #instructions {
    margin-top: 8px;
    font-size: 0.78rem;
    color: #8ab;
    text-align: center;
    padding: 0 8px;
  }

  /* â”€â”€ Compact layout for narrow phones â”€â”€ */
  @media (max-width: 480px) {
    body { padding: 8px 4px 12px; }
    #branding { margin-bottom: 6px; gap: 4px; }
    #logo-wrap { padding: 7px 14px 6px; }
    #hud { font-size: 0.95rem; gap: 14px; margin-bottom: 6px; }
    #scoreboard { gap: 8px; font-size: 0.75rem; padding: 6px 8px; }
    .score-entry .animal-name { font-size: 0.65rem; }
    .score-entry .points-label { font-size: 0.85rem; }
    #instructions { font-size: 0.7rem; }
  }
</style>
</head>
<body>

<div id="branding">
  <div id="logo-wrap">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 566.93 108.72" id="mrf-logo" aria-label="Muddy River Festival">
      <style>.cls-1{fill:#ffd331;}</style>
      <g><path class="cls-1" d="M49.84,37.28c-.81,0-2.03,1.21-3.24,3.65l-7.02,13.78c-1.22,2.03-2.43,2.97-3.51,2.97-1.22,0-2.3-1.08-3.24-2.97-1.08-2.03-3.11-6.08-7.02-13.37-1.48-2.84-2.57-4.19-3.38-4.19-.67,0-1.08,1.22-1.08,3.65v11.21c0,4.32.54,8.92,3.78,9.73,4.19,1.08,5.67,2.03,5.67,3.78,0,2.02-4.59,2.83-13.24,2.83h-4.32c-8.64,0-13.24-.81-13.24-2.83,0-1.76,1.48-2.7,5.67-3.78,3.38-.81,3.78-5.4,3.78-9.73v-27.69c0-4.32-.41-8.91-3.78-9.73-4.19-.94-5.67-1.89-5.67-3.65,0-2.02,4.59-2.97,13.24-2.97h4.86c6.08,0,8.78-.54,12.02,5.4,1.49,2.43,4.86,8.64,7.56,13.51.95,1.62,1.76,2.57,2.7,2.57.68,0,1.49-.81,2.16-2.57l6.89-13.1c2.84-5.54,7.43-5.81,11.21-5.81h4.46c4.73,0,7.83.14,9.59.54,2.03.4,2.57,3.64-.27,4.45-2.57.68-4.19,2.43-4.19,5.67v39.03c0,3.24,1.49,5,4.19,5.81,2.7.67,2.3,3.92.27,4.32-1.76.4-4.86.54-9.59.54h-8.91c-4.59,0-7.83-.14-9.59-.54-2.03-.4-2.3-3.65.27-4.32,2.84-.81,4.32-2.57,4.32-5.81v-16.75c0-2.57-.54-3.65-1.35-3.65Z"/><path class="cls-1" d="M105.49,59.56c3.24,0,5.4-2.56,5.4-7.16v-14.85c0-3.78-1.08-6.21-3.92-8.11-2.3-1.48-1.76-4.05.81-4.32,6.62-.67,12.02-3.78,16.34-5.81,1.08-.54,1.89-.67,2.7-.67,1.49,0,2.43.94,2.43,2.7v36.6c0,3.24.54,5,3.51,5.81,2.43.67,2.16,3.38.27,3.78s-4.19.54-8.91.54h-6.75c-4.46,0-6.21-2.3-6.48-5.27-3.11,3.24-7.83,5.67-14.72,5.67-10.4,0-14.32-6.62-14.32-15.53v-15.4c0-3.78-.94-6.21-3.78-8.11-2.3-1.48-2.03-4.05.68-4.32,6.62-.67,12.16-3.78,16.48-5.81,1.08-.54,1.89-.67,2.7-.67,1.49,0,2.43.94,2.43,2.7,0,3.24-.14,9.46-.14,16.62v14.72c0,4.19,1.62,6.89,5.27,6.89Z"/><path class="cls-1" d="M169.52,62l-.95-3.38c-3.11,4.86-8.37,9.45-16.21,9.45-10.4,0-17.96-8.51-17.96-23.23,0-15.67,7.83-25.26,19.04-25.26,5.81,0,9.86,4.05,13.24,7.16,1.35,1.22,1.35-.27,1.35-2.3,0-3.78-.95-6.21-3.78-8.11-2.3-1.48-2.3-3.92-.14-4.32,6.75-1.35,13.37-4.73,18.23-10.4.95-1.08,1.89-1.62,2.84-1.62,1.22,0,2.16,1.08,2.16,2.97,0,3.24-.94,9.18-.94,16.34v33.5c0,4.05,1.08,6.08,2.84,6.08.54,0,1.08-.13,1.62-.4,1.76-.81,2.43,1.48,1.35,2.97-2.84,4.19-8.91,7.02-13.91,7.02h-.94c-3.65,0-6.48-1.89-7.83-6.48ZM153.71,44.71c.81,7.56,3.78,12.83,7.97,12.83,6.08,0,6.35-9.59,6.35-13.78v-.27c0-9.18-3.38-15.26-8.64-14.59-4.46.41-6.62,6.62-5.67,15.8Z"/><path class="cls-1" d="M228.14,62l-.95-3.38c-3.11,4.86-8.37,9.45-16.21,9.45-10.4,0-17.96-8.51-17.96-23.23,0-15.67,7.83-25.26,19.04-25.26,5.81,0,9.86,4.05,13.24,7.16,1.35,1.22,1.35-.27,1.35-2.3,0-3.78-.95-6.21-3.78-8.11-2.3-1.48-2.3-3.92-.14-4.32,6.75-1.35,13.37-4.73,18.23-10.4.95-1.08,1.89-1.62,2.84-1.62,1.22,0,2.16,1.08,2.16,2.97,0,3.24-.94,9.18-.94,16.34v33.5c0,4.05,1.08,6.08,2.84,6.08.54,0,1.08-.13,1.62-.4,1.76-.81,2.43,1.48,1.35,2.97-2.84,4.19-8.91,7.02-13.91,7.02h-.95c-3.65,0-6.48-1.89-7.83-6.48ZM212.34,44.71c.81,7.56,3.78,12.83,7.97,12.83,6.08,0,6.35-9.59,6.35-13.78v-.27c0-9.18-3.38-15.26-8.64-14.59-4.46.41-6.62,6.62-5.67,15.8Z"/><path class="cls-1" d="M280.55,59.56c3.38,0,5.4-2.7,5.4-7.16v-14.99c0-3.78-1.08-6.08-3.78-7.97-2.43-1.62-1.89-4.19.68-4.46,6.75-.54,11.89-3.65,16.48-5.81.94-.4,1.89-.67,2.57-.67,1.48,0,2.57.94,2.57,2.7v43.09c0,18.1-10.94,24.72-26.88,24.72s-19.99-3.78-32.28-3.78-15.94,3.24-18.37,3.24c-1.35,0-2.03-1.35-2.03-3.92,0-7.7,5-13.91,16.07-13.91,18.91,0,22.42,12.96,36.87,12.96,5.27,0,8.11-2.7,8.11-8.78v-12.02c-3.11,3.24-7.83,5.67-14.72,5.67-10.4,0-14.18-6.62-14.18-15.67v-15.4c0-3.78-1.22-6.08-3.92-7.97-2.43-1.62-1.89-4.19.68-4.46,6.75-.54,12.16-3.65,16.48-5.81,1.08-.4,1.89-.67,2.7-.67,1.48,0,2.43.94,2.43,2.7v31.47c0,4.05,1.48,6.89,5.13,6.89Z"/></g>
      <g><path class="cls-1" d="M331.76,92.06c.49-1.42.74-1.73,1.23-1.79.56,0,1.05.62,1.54,2.35l1.24,4.38c.49,1.79.31,2.59-.19,2.78-.12.06-.25.06-.37.06-.49,0-1.05-.43-2.1-1.67-.8-.99-2.16-1.36-3.52-1.36-1.23,0-1.79.5-1.79,1.61v4.63c0,1.85.68,2.72,2.59,3.27,1.17.31.99,1.79.06,1.98-.74.18-2.84.25-5,.25h-4.01c-2.16,0-3.64-.06-4.38-.25-.93-.19-1.05-1.67.12-1.98,1.3-.37,1.91-1.17,1.91-2.66v-17.96c0-1.48-.68-2.29-1.91-2.59-1.23-.37-1.05-1.85-.12-2.04.74-.19,2.22-.13,4.38-.13h14.82c2.47,0,3.02.74,3.39,3.71l.25,1.91c.43,3.15.06,4.44-.68,4.57-.87.12-1.42-.74-3.46-3.77-1.91-2.9-2.78-3.33-5.43-3.33h-.49c-1.67,0-2.04,1.23-2.04,2.47v5.49c0,1.17.56,1.6,1.73,1.6.99,0,1.85-.25,2.22-1.54Z"/><path class="cls-1" d="M370.45,91.13c-.8.12-1.36-.74-3.39-3.77-1.91-2.9-2.84-3.33-5.43-3.33h-.56c-1.67,0-2.04,1.23-2.04,2.47v4.88c0,1.17.62,1.6,1.79,1.6.99,0,1.79-.25,2.22-1.54.43-1.42.68-1.73,1.17-1.79.62,0,1.05.62,1.54,2.35l1.23,4.38c.49,1.79.31,2.59-.18,2.78-.12.06-.25.06-.37.06-.49,0-1.05-.43-2.1-1.67-.8-.99-2.1-1.36-3.52-1.36-1.24,0-1.79.49-1.79,1.6v3.89c0,2.41,1.36,3.64,3.15,3.64h.43c2.9,0,4.14-.99,6.11-3.95s2.71-3.83,3.52-3.71c.86.12,1.05.87.68,4.51-.12.87-.25,1.79-.37,2.6-.43,2.96-.99,3.64-3.4,3.64h-16.48c-2.16,0-3.58.06-4.38-.12-.93-.19-1.05-1.67.12-1.98,1.3-.37,1.91-1.17,1.91-2.66v-17.96c0-1.48-.68-2.29-1.91-2.59-1.23-.37-1.05-1.85-.12-2.04.8-.19,2.22-.13,4.38-.13h14.88c2.41,0,3.02.74,3.39,3.71l.19,1.91c.31,3.15.06,4.44-.68,4.57Z"/><path class="cls-1" d="M393.16,80.88c3.64,0,7.16.74,9.26,1.98,1.23.8,1.61,2.1,1.61,3.33,0,3.02-1.54,4.07-3.15,4.07-1.73,0-2.72-.8-4.32-3.09-1.48-2.1-2.84-3.52-4.69-3.52-2.04,0-3.27,1.05-3.27,2.35,0,1.6,1.11,3.4,7.53,5.06,6.54,1.67,9.32,4.38,9.32,8.52,0,5.93-5.43,9.14-12.72,9.14-6.42,0-11.36-1.79-12.1-5.56-.56-2.78,1.11-4.69,3.95-4.69,2.22,0,3.89,1.17,4.69,3.89.68,2.28,2.35,3.46,4.2,3.46,1.98,0,3.58-.99,3.58-2.9s-1.67-3.46-7.04-5.06c-5.99-1.79-9.51-4.44-9.51-8.89,0-5.13,5.19-8.09,12.66-8.09Z"/><path class="cls-1" d="M430.81,103.54c0,1.48.99,2.41,2.28,2.78,1.24.31,1.05,1.79.12,1.98-.8.18-2.59.25-4.69.25h-4.07c-2.16,0-3.89-.06-4.69-.25-.92-.19-1.05-1.67.12-1.98,1.3-.37,2.22-1.3,2.22-2.78l.06-17.04c0-1.24-.37-2.47-1.54-2.47h-.19c-.92,0-1.48.43-3.46,3.33-2.1,3.15-3.02,3.95-3.95,3.77-.74-.12-1.23-1.48-.62-4.57l.31-1.91c.62-2.96.99-3.71,3.4-3.71h20.74c2.41,0,2.78.74,3.33,3.71l.37,1.91c.62,3.09.12,4.44-.62,4.57h-.25c-.86,0-1.79-.93-3.7-3.77-1.91-2.9-2.53-3.33-3.46-3.33h-.18c-1.17,0-1.54,1.23-1.54,2.47v17.04Z"/><path class="cls-1" d="M448.58,83.23c-1.23-.37-1.05-1.85-.12-2.04.8-.19,2.28-.25,4.38-.25h4.07c2.16,0,3.58.06,4.38.25.93.18,1.17,1.67-.12,2.04-1.17.31-1.91,1.11-1.91,2.59v17.84c0,1.48.68,2.29,1.91,2.66,1.23.31,1.05,1.79.12,1.98-.8.18-2.22.25-4.38.25h-4.07c-2.1,0-3.58-.06-4.38-.25-.93-.19-1.11-1.67.12-1.98,1.3-.37,1.98-1.17,1.98-2.66v-17.84c0-1.48-.68-2.28-1.98-2.59Z"/><path class="cls-1" d="M487.53,98.17c.37,0,.74-.37.99-1.05l4.26-10.19c.68-1.6-.43-3.15-2.59-3.76-1.23-.31-1.05-1.79-.12-1.98.8-.19,1.48-.25,3.64-.25h3.02c2.16,0,2.9.06,3.7.25.92.18,1.11,1.67-.12,1.98-2.41.68-3.7,2.41-4.38,4.13l-7.65,18.15c-.87,2.1-1.11,3.09-3.46,3.09-2.16,0-3.21-.68-3.77-2.04l-8.7-20.68c-.56-1.36-.68-2.28-1.91-2.65-1.23-.31-1.05-1.79-.12-1.98.74-.19,2.22-.25,4.38-.25h4.01c2.16,0,3.64.06,4.38.25.93.18,1.11,1.67-.06,1.98-1.3.37-1.85,1.23-1.23,2.65l4.69,11.24c.31.74.68,1.11,1.05,1.11Z"/><path class="cls-1" d="M502.09,106.32c2.47-.68,3.7-2.41,4.38-4.07l5.93-14.14c.62-1.36.56-2.29-.06-3.27-.62-.87-1.23-1.42-2.04-1.6-1.23-.37-1.05-1.85-.12-2.04.74-.19,2.22-.25,4.38-.25h3.21c2.04,0,2.9.31,3.52.87.86.8.68,2.53,1.23,3.89l7.53,17.96c.56,1.36.68,2.29,1.98,2.66,1.17.31.99,1.79.06,1.98-.74.18-2.22.25-4.38.25h-4.01c-2.16,0-3.64-.06-4.38-.25-.93-.19-1.05-1.67.12-1.98,1.3-.37,1.79-1.24,1.17-2.66l-.37-.93c-.56-1.17-1.48-1.42-2.9-1.42h-5.19c-1.54,0-2.04.31-2.65,1.6-.37,1.54.74,2.84,2.72,3.4,1.23.31,1.05,1.79.12,1.98-.8.18-1.48.25-3.64.25h-3.02c-2.16,0-2.9-.06-3.71-.25-.92-.19-1.05-1.67.12-1.98ZM514.87,90.02c-.06.18-.19.43-.25.62l-2.59,6.24c-.25.92.06,1.23,1.36,1.23h3.21c1.3,0,1.48-.37,1.17-1.23l-2.65-6.24c-.06-.18-.19-.43-.25-.62Z"/><path class="cls-1" d="M551.9,101.68c0,2.41,1.3,3.64,3.09,3.64h.43c2.59,0,3.39-.56,5.12-3.64,1.73-3.09,2.28-4.01,3.15-4.01.99,0,1.54,1.42,1.36,5.49-.19,3.21-1.23,5.25-3.83,5.25h-15.74c-2.16,0-3.58.06-4.38-.12-.93-.19-1.05-1.67.12-1.98,1.3-.37,1.91-1.17,1.91-2.66v-17.84c0-1.48-.68-2.28-1.91-2.59-1.23-.37-1.05-1.85-.12-2.04.8-.19,2.22-.25,4.38-.25h4.08c2.1,0,3.58.06,4.38.25.92.18,1.17,1.67-.12,2.04-1.17.31-1.91,1.11-1.91,2.59v15.87Z"/></g>
      <g><path class="cls-1" d="M354.59,43.09c-2.84,0-4.32.54-4.73,2.3v12.02c0,3.24,1.49,5,4.19,5.81,2.7.67,2.3,3.92.27,4.32-1.76.4-5,.54-9.59.54h-8.91c-4.73,0-7.83-.14-9.59-.54-2.03-.41-2.3-3.65.27-4.32,2.84-.81,4.19-2.57,4.19-5.81V18.37c0-3.24-1.48-5-4.19-5.67-2.7-.81-2.3-4.05-.27-4.46,1.76-.4,4.86-.27,9.59-.27h17.69c18.64,0,28.9,5.94,28.9,16.61,0,7.97-5.4,12.7-13.51,14.86,9.59,2.3,11.62,7.3,12.43,13.24.95,6.89,2.16,9.59,5.67,10.54,2.7.67,2.16,4.05,0,4.45-1.62.41-5.81.54-10.53.54h-2.03c-7.7,0-9.72-.27-11.89-10.54-2.43-12.02-4.46-14.59-7.97-14.59ZM355.4,36.06h.27c5.4,0,8.64-3.38,8.64-10.94,0-6.48-3.65-10.4-9.05-10.4h-2.43c-2.16,0-2.97.54-2.97,2.57v12.56c0,4.73,2.16,6.21,5.54,6.21Z"/><path class="cls-1" d="M417.94,67.53c-1.89.4-4.32.54-8.91.54h-8.24c-4.73,0-7.16-.14-8.92-.54-2.03-.41-2.3-3.11.27-3.78,2.84-.81,3.51-2.57,3.51-5.81v-20.4c0-3.78-.95-6.21-3.78-8.1-2.3-1.49-1.89-4.05.68-4.32,6.75-.68,13.1-2.43,17.42-4.46,1.08-.54,1.89-.67,2.7-.67,1.49,0,2.43.95,2.43,2.7,0,3.24-1.08,8.1-1.08,15.26v19.99c0,3.24.67,5,3.65,5.81,2.57.67,2.16,3.38.27,3.78ZM401.87,19.04c-5.27,0-9.59-2.57-10.53-7.43-1.22-5.67,3.65-10.26,10.13-11.35,1.22-.27,2.3-.27,3.38-.27,5.27,0,9.59,2.43,10.54,7.29.95,5.94-3.78,10.26-10.4,11.48-1.08.14-2.16.27-3.11.27Z"/><path class="cls-1" d="M453.2,60.51c-2.43,6.08-4.86,7.56-7.16,7.56h-1.08c-3.11,0-5-.67-7.83-7.43-.81-1.76-10.94-26.2-12.16-29.18-2.84-6.62-3.92-7.02-5.94-7.56-1.89-.54-2.03-3.38.14-3.78,2.43-.4,7.97-.54,13.37-.54h.41c2.97,0,10.81.14,13.24.54,2.16.41,2.03,3.24.14,3.78-2.7.67-3.24,2.43-2.7,3.92,1.49,3.64,3.78,9.45,4.86,12.29,1.76,4.32,2.16,5,3.38,5,1.35,0,2.43-2.43,4.86-8.51,3.11-7.7,2.97-9.99.68-11.21-1.89-.95-2.84-1.62-2.84-2.83,0-2.16,3.51-2.97,10.67-2.97,6.48,0,9.46,1.08,9.46,2.84,0,1.35-1.35,2.3-4.59,3.24-2.16.67-3.38,2.7-4.73,5.54-1.22,2.7-9.18,21.88-12.16,29.31Z"/><path class="cls-1" d="M495.61,46.06c-2.03,0-5.13.27-4.32,2.7,2.84,4.86,7.29,8.11,12.7,8.11,4.73,0,7.56-1.22,9.86-2.97.27-.27.68-.4.95-.4,1.08,0,1.62,1.76.95,3.11-2.57,5-8.51,11.75-22.02,11.75-12.7,0-23.77-7.97-23.77-23.77s12.16-24.99,25.12-24.99,20.93,6.75,20.93,14.45c0,10.67-12.29,12.02-20.39,12.02ZM492.37,41.33c3.92,0,5.27-2.97,5.27-7.3,0-4.73-1.49-9.05-4.46-9.05s-5.4,3.92-5.4,10.26v1.76c.27,3.24,1.89,4.32,4.59,4.32Z"/><path class="cls-1" d="M544.78,67.53c-1.89.4-4.19.54-8.91.54h-8.11c-4.73,0-7.29-.14-8.91-.54-2.03-.41-2.3-3.11.27-3.78,2.84-.81,3.51-2.57,3.51-5.81v-20.4c0-3.78-.94-6.21-3.78-8.1-2.3-1.49-2.03-4.05.68-4.32,6.62-.68,12.02-3.78,16.34-5.81,1.08-.54,2.03-.67,2.7-.67,1.62,0,2.57.95,2.57,2.7,0,1.62-.14,4.19-.14,7.16,2.97-5,8.37-8.92,14.99-8.92s10.94,4.86,10.94,11.62c0,7.83-5.54,12.7-10.81,12.7-3.65,0-5.94-1.76-7.29-5.67-1.22-3.51-2.16-6.21-4.32-6.21-2.3,0-3.51,3.24-3.51,5.94v19.99c0,3.24.54,5,3.65,5.81,2.43.67,2.03,3.38.14,3.78Z"/></g>
    </svg>
  </div>
  <p id="subtitle">Spot the wildlife along the river Â· <a href="https://www.muddyriverfestival.com" target="_blank" rel="noopener" id="website-link">www.muddyriverfestival.com</a></p>
</div>

<div id="hud">
  <div>Score: <span id="score-display">0</span></div>
  <div>Time: <span id="timer-display">60</span>s</div>
  <div>Combo: <span id="combo-display">x1</span></div>
</div>

<div id="game-wrapper">
  <canvas id="gameCanvas" width="800" height="450"></canvas>
  <div id="message-box">
    <h2 id="msg-title">Ready?</h2>
    <p id="msg-body">Click creatures before they disappear!<br>Rare animals are worth more points.</p>
    <button id="restart-btn">Start Game</button>
  </div>
</div>

<div id="scoreboard">
  <div class="score-entry"><div class="animal-name">ğŸ¦ Ibis</div><div class="points-label">10 pts</div></div>
  <div class="score-entry"><div class="animal-name">ğŸŸ Mullet</div><div class="points-label">15 pts</div></div>
  <div class="score-entry"><div class="animal-name">ğŸ¦€ Mudcrab</div><div class="points-label">20 pts</div></div>
  <div class="score-entry"><div class="animal-name">ğŸ¦ Blue-tongue</div><div class="points-label">25 pts</div></div>
  <div class="score-entry"><div class="animal-name">ğŸ¦© Pelican â˜…</div><div class="points-label">50 pts</div></div>
</div>

<p id="instructions">Click on creatures to spot them Â· Rare sightings give combo bonuses!</p>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

// â”€â”€ Colour palette â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SKY_TOP    = '#87CEEB';
const SKY_BOT    = '#c8e8f5';
const BUSH_DARK  = '#2d5a1b';
const BUSH_MID   = '#4a8f3f';
const BUSH_LIGHT = '#6abf5e';
const WATER_TOP  = '#1a6b8a';
const WATER_BOT  = '#0d3d52';
const BANK_TOP   = '#b5854a';
const BANK_BOT   = '#8a6030';
const MUD_COL    = '#7a5c38';
const ROCK_COL   = '#8a8070';

// â”€â”€ Animal definitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ANIMALS = {
  ibis: {
    label: 'Ibis', points: 10, rarity: 0.30,
    zone: 'bank', color: '#f0f0f0', accentColor: '#1a1a1a',
    draw: drawIbis
  },
  mullet: {
    label: 'Mullet', points: 15, rarity: 0.25,
    zone: 'water', color: '#6a8fa0', accentColor: '#c0d8e0',
    draw: drawMullet
  },
  mudcrab: {
    label: 'Mudcrab', points: 20, rarity: 0.20,
    zone: 'mud', color: '#8B4513', accentColor: '#cd7f32',
    draw: drawMudcrab
  },
  bluetongue: {
    label: 'Blue-tongue', points: 25, rarity: 0.15,
    zone: 'bank', color: '#7a6a50', accentColor: '#4169e1',
    draw: drawBluetongue
  },
  pelican: {
    label: 'Pelican', points: 50, rarity: 0.10,
    zone: 'sky', color: '#ffffff', accentColor: '#ff8c00',
    draw: drawPelican
  }
};

// â”€â”€ Scene layout constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SCENE = {
  skyTop:    0,
  skyBot:    110,   // sky â†’ treeline
  treeBot:   160,   // bottom of trees / top of bank
  bankTop:   160,
  bankBot:   230,   // where water starts
  waterTop:  230,
  waterBot:  390,
  mudTop:    220,
  mudBot:    250
};

// â”€â”€ Zone â†’ y-range helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function zoneY(zone) {
  switch(zone) {
    case 'sky':   return { min: SCENE.skyTop + 20,  max: SCENE.skyBot - 10 };
    case 'bank':  return { min: SCENE.bankTop + 10, max: SCENE.bankBot - 10 };
    case 'water': return { min: SCENE.waterTop + 20, max: SCENE.waterBot - 30 };
    case 'mud':   return { min: SCENE.mudTop,       max: SCENE.mudBot };
    default:      return { min: 50, max: 400 };
  }
}

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let gameState = 'idle'; // idle | playing | over
let score = 0;
let timeLeft = 60;
let combo = 1;
let comboTimer = 0;
let creatures = [];
let particles = [];
let floatTexts = [];
let bgTrees = [];
let waterOffset = 0;
let timerInterval = null;
let spawnTimer = 0;
let SPAWN_INTERVAL = 120; // frames

// â”€â”€ Background trees â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildTrees() {
  bgTrees = [];
  for (let i = 0; i < 22; i++) {
    bgTrees.push({
      x: Math.random() * W,
      h: 50 + Math.random() * 55,
      w: 18 + Math.random() * 28,
      layer: Math.random()
    });
  }
  bgTrees.sort((a, b) => a.layer - b.layer);
}

// â”€â”€ Drawing helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawScene() {
  // Sky gradient
  let skyGrad = ctx.createLinearGradient(0, 0, 0, SCENE.skyBot);
  skyGrad.addColorStop(0, '#5ba3d4');
  skyGrad.addColorStop(1, '#c8e8f5');
  ctx.fillStyle = skyGrad;
  ctx.fillRect(0, 0, W, SCENE.skyBot);

  // Sun
  ctx.save();
  ctx.beginPath();
  ctx.arc(W - 80, 45, 28, 0, Math.PI * 2);
  let sunGrad = ctx.createRadialGradient(W-80,45,4, W-80,45,28);
  sunGrad.addColorStop(0, '#fffde0');
  sunGrad.addColorStop(1, '#ffe066');
  ctx.fillStyle = sunGrad;
  ctx.fill();
  ctx.restore();

  // Background treeline â€” eucalyptus gum trees
  bgTrees.forEach(t => {
    ctx.save();
    const cx = t.x + t.w / 2;
    const base = SCENE.treeBot;
    const trunkH = t.h * 0.62;
    const trunkW = Math.max(3, t.w * 0.13);
    // Depth-based colour fade
    const d = t.layer; // 0=far, 1=near
    // Trunk: pale silver-white eucalyptus bark with patches
    const trunkLight = `rgba(${190+Math.floor(d*40)},${185+Math.floor(d*35)},${170+Math.floor(d*30)},${0.55+d*0.4})`;
    const trunkDark  = `rgba(${140+Math.floor(d*30)},${130+Math.floor(d*25)},${110+Math.floor(d*20)},${0.55+d*0.4})`;
    let tGrad = ctx.createLinearGradient(cx - trunkW, 0, cx + trunkW, 0);
    tGrad.addColorStop(0,   trunkDark);
    tGrad.addColorStop(0.3, trunkLight);
    tGrad.addColorStop(0.7, trunkLight);
    tGrad.addColorStop(1,   trunkDark);
    ctx.fillStyle = tGrad;
    // Slightly curved trunk via quad bezier fill
    ctx.beginPath();
    ctx.moveTo(cx - trunkW, base);
    ctx.quadraticCurveTo(cx - trunkW + t.w*0.06, base - trunkH*0.5, cx - trunkW*0.5, base - trunkH);
    ctx.lineTo(cx + trunkW*0.5, base - trunkH);
    ctx.quadraticCurveTo(cx + trunkW - t.w*0.06, base - trunkH*0.5, cx + trunkW, base);
    ctx.closePath();
    ctx.fill();

    // Bark strip texture â€” a few darker vertical streaks
    ctx.strokeStyle = `rgba(${100+Math.floor(d*30)},${90+Math.floor(d*20)},${70+Math.floor(d*20)},0.35)`;
    ctx.lineWidth = 1;
    for (let s = 0; s < 3; s++) {
      const sx = cx - trunkW*0.6 + s * trunkW*0.6;
      ctx.beginPath();
      ctx.moveTo(sx, base - trunkH * 0.1);
      ctx.quadraticCurveTo(sx + 2, base - trunkH * 0.5, sx - 1, base - trunkH * 0.85);
      ctx.stroke();
    }

    // Canopy: drooping, irregular eucalyptus leaf clusters
    // Silvery-green, blue-green palette typical of gums
    const leafColors = [
      `rgba(${100+Math.floor(d*40)},${130+Math.floor(d*30)},${90+Math.floor(d*20)},${0.7+d*0.25})`,
      `rgba(${80+Math.floor(d*40)},${115+Math.floor(d*30)},${85+Math.floor(d*20)},${0.65+d*0.25})`,
      `rgba(${120+Math.floor(d*35)},${145+Math.floor(d*25)},${100+Math.floor(d*20)},${0.6+d*0.25})`,
      `rgba(${90+Math.floor(d*40)},${125+Math.floor(d*30)},${110+Math.floor(d*20)},${0.6+d*0.25})`,
    ];
    const canopyTop = base - t.h;
    const canopyMid = base - trunkH;
    // Draw several drooping blob clusters
    const clusters = [
      { ox: 0,           oy: canopyTop,        rx: t.w*0.55, ry: t.h*0.22 },
      { ox: -t.w*0.38,  oy: canopyTop+t.h*0.1, rx: t.w*0.38, ry: t.h*0.18 },
      { ox:  t.w*0.38,  oy: canopyTop+t.h*0.08,rx: t.w*0.35, ry: t.h*0.17 },
      { ox: -t.w*0.22,  oy: canopyTop+t.h*0.22,rx: t.w*0.30, ry: t.h*0.16 },
      { ox:  t.w*0.18,  oy: canopyTop+t.h*0.25,rx: t.w*0.28, ry: t.h*0.15 },
      // Drooping lower wisps
      { ox: -t.w*0.42,  oy: canopyMid - t.h*0.12, rx: t.w*0.18, ry: t.h*0.22 },
      { ox:  t.w*0.40,  oy: canopyMid - t.h*0.10, rx: t.w*0.17, ry: t.h*0.20 },
      { ox:  t.w*0.08,  oy: canopyMid - t.h*0.08, rx: t.w*0.22, ry: t.h*0.18 },
    ];
    clusters.forEach((cl, ci) => {
      ctx.fillStyle = leafColors[ci % leafColors.length];
      ctx.beginPath();
      // Slightly irregular ellipse via small rotation
      ctx.ellipse(cx + cl.ox, cl.oy, cl.rx, cl.ry, (ci * 0.4) % Math.PI, 0, Math.PI*2);
      ctx.fill();
    });

    ctx.restore();
  });

  // Bank / ground
  let bankGrad = ctx.createLinearGradient(0, SCENE.bankTop, 0, SCENE.bankBot + 20);
  bankGrad.addColorStop(0, '#c8a86a');
  bankGrad.addColorStop(0.5, '#b5854a');
  bankGrad.addColorStop(1, '#8a6030');
  ctx.fillStyle = bankGrad;
  ctx.fillRect(0, SCENE.bankTop, W, SCENE.bankBot - SCENE.bankTop + 20);

  // Mud strip at waterline
  ctx.fillStyle = MUD_COL;
  ctx.fillRect(0, SCENE.mudTop, W, SCENE.mudBot - SCENE.mudTop);

  // Scattered pebbles/rocks on bank
  for (let i = 0; i < 18; i++) {
    let rx = (i * 47 + 30) % W;
    let ry = SCENE.bankTop + 15 + (i * 13) % 40;
    ctx.fillStyle = i % 3 === 0 ? '#a09080' : '#c0b098';
    ctx.beginPath();
    ctx.ellipse(rx, ry, 7 + i%5, 4 + i%3, 0.3, 0, Math.PI*2);
    ctx.fill();
  }

  // Water
  waterOffset = (waterOffset + 0.4) % 60;
  let waterGrad = ctx.createLinearGradient(0, SCENE.waterTop, 0, SCENE.waterBot);
  waterGrad.addColorStop(0, '#2a8aaa');
  waterGrad.addColorStop(0.4, '#1a6b8a');
  waterGrad.addColorStop(1, '#0d3d52');
  ctx.fillStyle = waterGrad;
  ctx.fillRect(0, SCENE.waterTop, W, SCENE.waterBot - SCENE.waterTop);

  // Water ripples
  ctx.strokeStyle = 'rgba(255,255,255,0.12)';
  ctx.lineWidth = 1.5;
  for (let row = 0; row < 8; row++) {
    let ry = SCENE.waterTop + 25 + row * 20;
    for (let wx = -60 + waterOffset; wx < W + 60; wx += 60) {
      ctx.beginPath();
      ctx.moveTo(wx, ry);
      ctx.bezierCurveTo(wx+15, ry-4, wx+30, ry+4, wx+60, ry);
      ctx.stroke();
    }
  }

  // Water glints
  ctx.fillStyle = 'rgba(255,255,255,0.25)';
  for (let g = 0; g < 12; g++) {
    let gx = ((g * 67 + waterOffset * 3) % W);
    let gy = SCENE.waterTop + 15 + (g * 17) % (SCENE.waterBot - SCENE.waterTop - 30);
    ctx.beginPath();
    ctx.ellipse(gx, gy, 8, 2, 0, 0, Math.PI*2);
    ctx.fill();
  }

  // River bank foreground edge (reeds/grass)
  drawReeds();

  // Bottom mud/shore
  ctx.fillStyle = '#6a4e2e';
  ctx.fillRect(0, SCENE.waterBot, W, H - SCENE.waterBot);
  // Rocks at bottom shore
  for (let r = 0; r < 10; r++) {
    ctx.fillStyle = r%2===0 ? ROCK_COL : '#706050';
    ctx.beginPath();
    ctx.ellipse(r * 82 + 30, SCENE.waterBot + 8, 22, 10, 0, 0, Math.PI*2);
    ctx.fill();
  }

  // Golf course nod â€” bottom right: putting green with flag
  drawGolfFlag();
}

function drawReeds() {
  ctx.strokeStyle = '#5a8a30';
  ctx.lineWidth = 2;
  for (let i = 0; i < 14; i++) {
    let rx = i * 58 + 15 + (i%3)*12;
    let rh = 25 + (i%4)*8;
    ctx.beginPath();
    ctx.moveTo(rx, SCENE.waterTop);
    ctx.quadraticCurveTo(rx + (i%2?4:-4), SCENE.waterTop - rh/2, rx + (i%2?3:-3), SCENE.waterTop - rh);
    ctx.stroke();
    // Reed head
    ctx.fillStyle = '#8B6914';
    ctx.beginPath();
    ctx.ellipse(rx + (i%2?3:-3), SCENE.waterTop - rh, 3, 7, 0.2, 0, Math.PI*2);
    ctx.fill();
  }
}

function drawGolfFlag() {
  ctx.save();
  const gx = W - 68;   // flag x position
  const gy = H - 14;   // ground level
  const poleH = 52;

  // Putting green â€” a tidy oval of short grass
  let greenGrad = ctx.createRadialGradient(gx, gy - 4, 4, gx, gy - 4, 38);
  greenGrad.addColorStop(0,   '#4fc94f');
  greenGrad.addColorStop(0.6, '#38a838');
  greenGrad.addColorStop(1,   '#2a8a2a');
  ctx.fillStyle = greenGrad;
  ctx.beginPath();
  ctx.ellipse(gx, gy - 4, 38, 14, 0, 0, Math.PI*2);
  ctx.fill();

  // Mown stripes â€” subtle lighter bands
  ctx.strokeStyle = 'rgba(255,255,255,0.12)';
  ctx.lineWidth = 4;
  for (let s = -28; s <= 28; s += 10) {
    ctx.beginPath();
    ctx.moveTo(gx + s, gy - 14);
    ctx.lineTo(gx + s, gy + 6);
    ctx.stroke();
  }

  // Hole cup
  ctx.fillStyle = '#111';
  ctx.beginPath();
  ctx.ellipse(gx, gy - 4, 5, 2.5, 0, 0, Math.PI*2);
  ctx.fill();

  // Flag pole
  ctx.strokeStyle = '#e8e0cc';
  ctx.lineWidth = 1.8;
  ctx.beginPath();
  ctx.moveTo(gx, gy - 4);
  ctx.lineTo(gx, gy - 4 - poleH);
  ctx.stroke();

  // Flag â€” triangular, red with a white stripe
  const fx = gx;
  const fy = gy - 4 - poleH;
  ctx.fillStyle = '#e02020';
  ctx.beginPath();
  ctx.moveTo(fx, fy);
  ctx.lineTo(fx + 22, fy + 10);
  ctx.lineTo(fx, fy + 20);
  ctx.closePath();
  ctx.fill();
  // White stripe on flag
  ctx.fillStyle = 'rgba(255,255,255,0.7)';
  ctx.beginPath();
  ctx.moveTo(fx, fy + 7);
  ctx.lineTo(fx + 22, fy + 10);
  ctx.lineTo(fx + 18, fy + 12);
  ctx.lineTo(fx, fy + 9);
  ctx.closePath();
  ctx.fill();

  // Tiny "19th hole" label
  ctx.fillStyle = 'rgba(255,255,220,0.75)';
  ctx.font = 'bold 8px Arial';
  ctx.textAlign = 'center';
  ctx.fillText('19th', gx, gy + 9);

  ctx.restore();
}

// â”€â”€ Animal draw functions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawIbis(x, y, scale, alpha) {
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Body
  ctx.fillStyle = '#f5f5f5';
  ctx.beginPath();
  ctx.ellipse(0, 0, 18, 11, 0, 0, Math.PI*2);
  ctx.fill();
  ctx.strokeStyle = '#ccc';
  ctx.lineWidth = 1;
  ctx.stroke();

  // Black wingtips
  ctx.fillStyle = '#1a1a1a';
  ctx.beginPath();
  ctx.ellipse(16, 2, 7, 5, 0.3, 0, Math.PI*2);
  ctx.fill();

  // Head
  ctx.fillStyle = '#1a1a1a';
  ctx.beginPath();
  ctx.ellipse(-18, -5, 7, 6, -0.2, 0, Math.PI*2);
  ctx.fill();

  // Curved beak
  ctx.strokeStyle = '#1a1a1a';
  ctx.lineWidth = 2.5;
  ctx.beginPath();
  ctx.moveTo(-23, -6);
  ctx.quadraticCurveTo(-38, -2, -36, 4);
  ctx.stroke();

  // Eye
  ctx.fillStyle = '#ffcc00';
  ctx.beginPath();
  ctx.arc(-20, -7, 2, 0, Math.PI*2);
  ctx.fill();

  // Legs
  ctx.strokeStyle = '#888';
  ctx.lineWidth = 1.5;
  ctx.beginPath(); ctx.moveTo(-5, 10); ctx.lineTo(-5, 22); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(5, 10); ctx.lineTo(5, 22); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(-5, 22); ctx.lineTo(-12, 26); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(-5, 22); ctx.lineTo(0, 27); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(5, 22); ctx.lineTo(0, 26); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(5, 22); ctx.lineTo(10, 27); ctx.stroke();

  ctx.restore();
}

function drawMullet(x, y, scale, alpha) {
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Tail fin
  ctx.fillStyle = '#5a7f90';
  ctx.beginPath();
  ctx.moveTo(20, 0);
  ctx.lineTo(32, -10);
  ctx.lineTo(32, 10);
  ctx.closePath();
  ctx.fill();

  // Body
  let grad = ctx.createLinearGradient(-22, -8, -22, 8);
  grad.addColorStop(0, '#8ab8cc');
  grad.addColorStop(0.4, '#5a8fa8');
  grad.addColorStop(1, '#3a6a80');
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.ellipse(0, 0, 22, 9, 0, 0, Math.PI*2);
  ctx.fill();

  // Lateral line
  ctx.strokeStyle = 'rgba(255,255,255,0.4)';
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(-15, -2);
  ctx.lineTo(18, -2);
  ctx.stroke();

  // Dorsal fin
  ctx.fillStyle = '#4a7a90';
  ctx.beginPath();
  ctx.moveTo(-5, -9);
  ctx.lineTo(0, -18);
  ctx.lineTo(10, -9);
  ctx.closePath();
  ctx.fill();

  // Head/mouth
  ctx.fillStyle = '#4a7a90';
  ctx.beginPath();
  ctx.ellipse(-20, 0, 7, 7, 0, 0, Math.PI*2);
  ctx.fill();

  // Eye
  ctx.fillStyle = '#fff';
  ctx.beginPath(); ctx.arc(-22, -1, 2.5, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = '#111';
  ctx.beginPath(); ctx.arc(-22, -1, 1.2, 0, Math.PI*2); ctx.fill();

  // Scales
  ctx.strokeStyle = 'rgba(255,255,255,0.2)';
  ctx.lineWidth = 0.8;
  for (let s = -10; s < 18; s += 7) {
    ctx.beginPath();
    ctx.arc(s, 0, 5, 0, Math.PI);
    ctx.stroke();
  }

  ctx.restore();
}

function drawMudcrab(x, y, scale, alpha) {
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Shell
  let shellGrad = ctx.createRadialGradient(-2,-2,2, 0,0,18);
  shellGrad.addColorStop(0, '#cd7f32');
  shellGrad.addColorStop(0.6, '#8B4513');
  shellGrad.addColorStop(1, '#5c2e0a');
  ctx.fillStyle = shellGrad;
  ctx.beginPath();
  ctx.ellipse(0, 0, 20, 14, 0, 0, Math.PI*2);
  ctx.fill();
  ctx.strokeStyle = '#5c2e0a';
  ctx.lineWidth = 1;
  ctx.stroke();

  // Shell lines
  ctx.strokeStyle = 'rgba(0,0,0,0.3)';
  ctx.lineWidth = 0.8;
  for (let l = -2; l <= 2; l++) {
    ctx.beginPath();
    ctx.moveTo(l*5, -14);
    ctx.lineTo(l*5, 14);
    ctx.stroke();
  }

  // Big claws
  function drawClaw(side) {
    ctx.save();
    ctx.scale(side, 1);
    // Upper arm
    ctx.fillStyle = '#a05520';
    ctx.beginPath();
    ctx.ellipse(26, -4, 10, 5, -0.4, 0, Math.PI*2);
    ctx.fill();
    // Claw pincers
    ctx.fillStyle = '#cd7f32';
    ctx.beginPath();
    ctx.ellipse(36, -9, 8, 4, -0.5, 0, Math.PI*2);
    ctx.fill();
    ctx.beginPath();
    ctx.ellipse(36, -1, 8, 3, 0.3, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
  }
  drawClaw(1);
  drawClaw(-1);

  // Walking legs (3 each side)
  ctx.strokeStyle = '#7a4010';
  ctx.lineWidth = 2;
  [-1, 1].forEach(side => {
    for (let l = 0; l < 3; l++) {
      let lx = side * (8 + l * 5);
      ctx.beginPath();
      ctx.moveTo(lx, 12);
      ctx.lineTo(lx + side*8, 22);
      ctx.lineTo(lx + side*12, 18);
      ctx.stroke();
    }
  });

  // Eyes on stalks
  [-8, 8].forEach(ex => {
    ctx.strokeStyle = '#5c2e0a';
    ctx.lineWidth = 1.5;
    ctx.beginPath(); ctx.moveTo(ex, -12); ctx.lineTo(ex, -18); ctx.stroke();
    ctx.fillStyle = '#111';
    ctx.beginPath(); ctx.arc(ex, -20, 3, 0, Math.PI*2); ctx.fill();
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(ex+1, -21, 1, 0, Math.PI*2); ctx.fill();
  });

  ctx.restore();
}

function drawBluetongue(x, y, scale, alpha) {
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Tail
  ctx.fillStyle = '#7a6a50';
  ctx.beginPath();
  ctx.moveTo(30, 3);
  ctx.quadraticCurveTo(55, 8, 65, 2);
  ctx.quadraticCurveTo(55, -2, 30, -3);
  ctx.closePath();
  ctx.fill();

  // Body
  let bodyGrad = ctx.createLinearGradient(-30, -10, -30, 10);
  bodyGrad.addColorStop(0, '#9a8a6a');
  bodyGrad.addColorStop(0.5, '#7a6a50');
  bodyGrad.addColorStop(1, '#5a4a30');
  ctx.fillStyle = bodyGrad;
  ctx.beginPath();
  ctx.ellipse(0, 0, 32, 11, 0, 0, Math.PI*2);
  ctx.fill();

  // Scale pattern
  ctx.fillStyle = 'rgba(0,0,0,0.15)';
  for (let sx = -25; sx < 30; sx += 8) {
    for (let sy = -1; sy <= 1; sy++) {
      ctx.beginPath();
      ctx.ellipse(sx + (sy*4), sy*4, 4, 3, 0, 0, Math.PI*2);
      ctx.fill();
    }
  }

  // Head
  let headGrad = ctx.createLinearGradient(-42, -8, -42, 8);
  headGrad.addColorStop(0, '#a08060');
  headGrad.addColorStop(1, '#6a5040');
  ctx.fillStyle = headGrad;
  ctx.beginPath();
  ctx.ellipse(-36, 0, 14, 10, 0, 0, Math.PI*2);
  ctx.fill();

  // Eye
  ctx.fillStyle = '#ffaa00';
  ctx.beginPath(); ctx.arc(-40, -3, 3, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = '#000';
  ctx.beginPath(); ctx.arc(-40, -3, 1.5, 0, Math.PI*2); ctx.fill();

  // Blue tongue flicking
  ctx.fillStyle = '#4169e1';
  ctx.beginPath();
  ctx.moveTo(-50, 0);
  ctx.lineTo(-58, -3);
  ctx.lineTo(-60, 0);
  ctx.lineTo(-58, 3);
  ctx.closePath();
  ctx.fill();

  // Legs
  ctx.strokeStyle = '#6a5a40';
  ctx.lineWidth = 2;
  [[-15, 1], [5, 1], [-15, -1], [5, -1]].forEach(([lx, side]) => {
    ctx.beginPath();
    ctx.moveTo(lx, 10 * side);
    ctx.lineTo(lx - 4, 18 * side);
    ctx.lineTo(lx + 4, 22 * side);
    ctx.stroke();
  });

  ctx.restore();
}

function drawPelican(x, y, scale, alpha) {
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Wings (spread)
  ctx.fillStyle = '#f0f0f0';
  // Left wing
  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.quadraticCurveTo(-30, -20, -55, -8);
  ctx.quadraticCurveTo(-40, 10, 0, 12);
  ctx.closePath();
  ctx.fill();
  ctx.strokeStyle = '#ccc'; ctx.lineWidth = 0.8; ctx.stroke();

  // Right wing
  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.quadraticCurveTo(30, -20, 55, -8);
  ctx.quadraticCurveTo(40, 10, 0, 12);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();

  // Wing tips (dark)
  ctx.fillStyle = '#1a1a1a';
  ctx.beginPath();
  ctx.moveTo(-40, -8);
  ctx.quadraticCurveTo(-55, -8, -55, -4);
  ctx.quadraticCurveTo(-48, 4, -35, 5);
  ctx.closePath();
  ctx.fill();
  ctx.beginPath();
  ctx.moveTo(40, -8);
  ctx.quadraticCurveTo(55, -8, 55, -4);
  ctx.quadraticCurveTo(48, 4, 35, 5);
  ctx.closePath();
  ctx.fill();

  // Body
  ctx.fillStyle = '#f8f8f8';
  ctx.beginPath();
  ctx.ellipse(0, 6, 18, 12, 0, 0, Math.PI*2);
  ctx.fill();

  // Neck + head
  ctx.fillStyle = '#f5f5f5';
  ctx.beginPath();
  ctx.ellipse(-10, -8, 8, 12, -0.3, 0, Math.PI*2);
  ctx.fill();
  ctx.beginPath();
  ctx.ellipse(-18, -18, 10, 9, -0.1, 0, Math.PI*2);
  ctx.fill();

  // Beak (long orange)
  ctx.fillStyle = '#ff8c00';
  ctx.beginPath();
  ctx.moveTo(-24, -20);
  ctx.lineTo(-48, -18);
  ctx.lineTo(-48, -14);
  ctx.lineTo(-24, -14);
  ctx.closePath();
  ctx.fill();

  // Throat pouch
  ctx.fillStyle = '#ff6600';
  ctx.beginPath();
  ctx.moveTo(-26, -14);
  ctx.quadraticCurveTo(-36, -8, -26, -8);
  ctx.closePath();
  ctx.fill();

  // Eye
  ctx.fillStyle = '#ff4400';
  ctx.beginPath(); ctx.arc(-20, -20, 3, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = '#000';
  ctx.beginPath(); ctx.arc(-20, -20, 1.5, 0, Math.PI*2); ctx.fill();

  // â˜… Rare star indicator
  ctx.fillStyle = '#f9e04b';
  ctx.font = 'bold 14px serif';
  ctx.textAlign = 'center';
  ctx.fillText('â˜…', 0, -30);

  ctx.restore();
}

// â”€â”€ Spawn a creature â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnCreature() {
  const keys = Object.keys(ANIMALS);
  // Weighted random by rarity
  let total = keys.reduce((s, k) => s + ANIMALS[k].rarity, 0);
  let r = Math.random() * total;
  let chosen;
  for (let k of keys) {
    r -= ANIMALS[k].rarity;
    if (r <= 0) { chosen = k; break; }
  }
  chosen = chosen || 'ibis';

  const def = ANIMALS[chosen];
  const zone = zoneY(def.zone);
  const y = zone.min + Math.random() * (zone.max - zone.min);
  const x = 80 + Math.random() * (W - 160);

  // life = frames; bobbing, scale, alpha
  let life = 180 + Math.random() * 180;
  let scale = 0.85 + Math.random() * 0.35;

  creatures.push({
    type: chosen,
    def,
    x, y,
    scale,
    life,
    maxLife: life,
    bobPhase: Math.random() * Math.PI * 2,
    bobAmp: def.zone === 'water' ? 4 : (def.zone === 'sky' ? 6 : 2),
    bobSpeed: 0.04 + Math.random() * 0.03,
    alpha: 0,
    fadingIn: true,
    clicked: false,
    clickAnim: 0,
    radius: def.zone === 'water' ? 30 : 36  // hitbox
  });
}

// â”€â”€ Particles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnParticles(x, y, color) {
  for (let i = 0; i < 14; i++) {
    let angle = Math.random() * Math.PI * 2;
    let speed = 1.5 + Math.random() * 3;
    particles.push({
      x, y,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed - 1,
      life: 40 + Math.random() * 30,
      maxLife: 60,
      color,
      size: 3 + Math.random() * 4
    });
  }
}

// â”€â”€ Float text â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnFloatText(x, y, text, color) {
  floatTexts.push({ x, y, text, color, life: 70, maxLife: 70, vy: -1.5 });
}

// â”€â”€ Combo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function addCombo() {
  combo = Math.min(combo + 0.5, 4);
  comboTimer = 180;
  document.getElementById('combo-display').textContent = 'x' + combo.toFixed(1);
}

function tickCombo() {
  if (comboTimer > 0) {
    comboTimer--;
  } else {
    if (combo > 1) {
      combo = Math.max(1, combo - 0.01);
      document.getElementById('combo-display').textContent = 'x' + combo.toFixed(1);
    }
  }
}

// â”€â”€ Click handler â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleInput(clientX, clientY) {
  if (gameState !== 'playing') return;
  const rect = canvas.getBoundingClientRect();
  const mx = (clientX - rect.left) * (W / rect.width);
  const my = (clientY - rect.top) * (H / rect.height);

  // Check creatures in reverse (topmost first)
  for (let i = creatures.length - 1; i >= 0; i--) {
    const c = creatures[i];
    if (c.clicked) continue;
    const bob = Math.sin(c.bobPhase) * c.bobAmp;
    const dy = my - (c.y + bob);
    const dx = mx - c.x;
    if (Math.sqrt(dx*dx + dy*dy) < c.radius * c.scale) {
      c.clicked = true;
      c.clickAnim = 1;
      const pts = Math.round(c.def.points * combo);
      score += pts;
      addCombo();
      document.getElementById('score-display').textContent = score;
      spawnParticles(c.x, c.y + bob, c.def.zone === 'water' ? '#7df' : '#ffd');
      const label = c.def.label === 'Pelican' ? `â˜… ${pts}pts!` : `+${pts}`;
      spawnFloatText(c.x, c.y + bob - 20, label, c.def.points >= 50 ? '#f9e04b' : '#fff');
      break;
    }
  }
}

canvas.addEventListener('click', e => handleInput(e.clientX, e.clientY));
canvas.addEventListener('touchstart', e => {
  e.preventDefault();
  handleInput(e.touches[0].clientX, e.touches[0].clientY);
}, { passive: false });

// â”€â”€ Main game loop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let frame = 0;
function gameLoop() {
  if (gameState !== 'playing') return;
  try {
  frame++;

  ctx.clearRect(0, 0, W, H);
  drawScene();

  // Spawn
  spawnTimer++;
  if (spawnTimer >= SPAWN_INTERVAL) {
    spawnTimer = 0;
    let toSpawn = 1 + (frame > 600 ? 1 : 0);
    for (let s = 0; s < toSpawn; s++) spawnCreature();
    SPAWN_INTERVAL = Math.max(60, SPAWN_INTERVAL - 0.5);
  }

  // Update + draw creatures
  creatures = creatures.filter(c => {
    c.bobPhase += c.bobSpeed;
    const bob = Math.sin(c.bobPhase) * c.bobAmp;

    if (c.fadingIn) {
      c.alpha = Math.min(1, c.alpha + 0.04);
      if (c.alpha >= 1) c.fadingIn = false;
    } else if (c.clicked) {
      c.alpha -= 0.06;
      c.clickAnim -= 0.05;
    } else {
      c.life--;
      if (c.life < 40) c.alpha = c.life / 40;
    }

    if (c.alpha <= 0) return false;

    const sc = c.scale * (c.clicked ? (1 + (1 - c.clickAnim) * 0.4) : 1);
    c.def.draw(c.x, c.y + bob, sc, c.alpha);

    // Label on hover (simple: always show faint label)
    if (!c.clicked && c.life > 60) {
      ctx.save();
      ctx.globalAlpha = c.alpha * 0.7;
      ctx.fillStyle = '#fff';
      ctx.font = `bold ${Math.round(12 * c.scale)}px Arial`;
      ctx.textAlign = 'center';
      ctx.shadowColor = '#000';
      ctx.shadowBlur = 4;
      ctx.fillText(c.def.label, c.x, c.y + bob - 28 * c.scale);
      ctx.restore();
    }

    return true;
  });

  // Update + draw particles
  particles = particles.filter(p => {
    p.x += p.vx; p.y += p.vy; p.vy += 0.12;
    p.life--;
    if (p.life <= 0) return false;
    const a = p.life / p.maxLife;
    const r = p.size * a;
    if (r < 0.1) return false;
    ctx.save();
    ctx.globalAlpha = a;
    ctx.fillStyle = p.color;
    ctx.beginPath();
    ctx.arc(p.x, p.y, r, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
    return true;
  });

  // Update + draw float texts
  floatTexts = floatTexts.filter(ft => {
    ft.y += ft.vy;
    ft.life--;
    const a = ft.life / ft.maxLife;
    ctx.save();
    ctx.globalAlpha = a;
    ctx.fillStyle = ft.color;
    ctx.font = 'bold 18px Arial';
    ctx.textAlign = 'center';
    ctx.shadowColor = '#000';
    ctx.shadowBlur = 6;
    ctx.fillText(ft.text, ft.x, ft.y);
    ctx.restore();
    return ft.life > 0;
  });

  tickCombo();
  } catch(e) { console.warn('gameLoop error:', e); }
  requestAnimationFrame(gameLoop);
}

// â”€â”€ Timer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startTimer() {
  timeLeft = 60;
  document.getElementById('timer-display').textContent = timeLeft;
  timerInterval = setInterval(() => {
    timeLeft--;
    document.getElementById('timer-display').textContent = timeLeft;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      endGame();
    }
  }, 1000);
}

// â”€â”€ Game flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startGame() {
  score = 0;
  combo = 1;
  comboTimer = 0;
  creatures = [];
  particles = [];
  floatTexts = [];
  frame = 0;
  spawnTimer = 0;
  SPAWN_INTERVAL = 120;
  document.getElementById('score-display').textContent = '0';
  document.getElementById('combo-display').textContent = 'x1';
  document.getElementById('message-box').style.display = 'none';
  if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
  gameState = 'playing';
  buildTrees();
  startTimer();
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameState = 'over';
  document.getElementById('msg-title').textContent = "Time's up! ğŸ¦˜";
  document.getElementById('msg-body').innerHTML =
    `You scored <strong style="color:#f9e04b;font-size:1.4rem">${score}</strong> points!<br><br>` +
    getRating(score);
  document.getElementById('restart-btn').textContent = 'Play Again';
  document.getElementById('message-box').style.display = 'block';
  // Keep drawing the scene
  (function finalDraw() {
    ctx.clearRect(0,0,W,H);
    drawScene();
    if (gameState === 'over') requestAnimationFrame(finalDraw);
  })();
}

function getRating(s) {
  if (s >= 500) return 'â­â­â­ Expert Naturalist!';
  if (s >= 300) return 'â­â­ Keen Observer!';
  if (s >= 150) return 'â­ Good Eye!';
  return 'Keep practising â€” the pelican is out there!';
}

// â”€â”€ Initial idle scene â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
buildTrees();
(function idleDraw() {
  ctx.clearRect(0,0,W,H);
  drawScene();
  if (gameState === 'idle') requestAnimationFrame(idleDraw);
})();
document.getElementById('message-box').style.display = 'block';
document.getElementById('msg-title').textContent = 'Muddy River Festival';
document.getElementById('msg-body').innerHTML =
  'Spot the wildlife along the river!<br>Click creatures before they disappear.<br><span style="color:#f9e04b">â˜… Pelican = 50 pts (rare!)</span><br><br><a href="https://www.muddyriverfestival.com" target="_blank" rel="noopener" style="color:#ffd331;font-size:0.85rem;text-decoration:none;">www.muddyriverfestival.com</a>';
document.getElementById('restart-btn').textContent = 'Start Game';
document.getElementById('restart-btn').onclick = startGame;
</script>
</body>
</html>
